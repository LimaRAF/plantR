<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Get Locality and Coordinates — getLoc • plantR</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Get Locality and Coordinates — getLoc" />
<meta property="og:description" content="This function uses the plantR locality strings to search for
existing localities and their respective coordinates in a
gazetteer, which can be
used to replace missing coordinates and in the validation process of the
locality information and geographical coordinates provided." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plantR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/plantr_introduction.html">An Introduction to __plantR__</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/LimaRAF/plantR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get Locality and Coordinates</h1>
    <small class="dont-index">Source: <a href='https://github.com/LimaRAF/plantR/blob/master/R/getLoc.R'><code>R/getLoc.R</code></a></small>
    <div class="hidden name"><code>getLoc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function uses the <strong>plantR</strong> locality strings to search for
existing localities and their respective coordinates in a
<a href='https://en.wikipedia.org/wiki/Gazetteer'>gazetteer</a>, which can be
used to replace missing coordinates and in the validation process of the
locality information and geographical coordinates provided.</p>
    </div>

    <pre class="usage"><span class='fu'>getLoc</span><span class='op'>(</span>
  <span class='va'>x</span>,
  str.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"resol.orig"</span>, <span class='st'>"loc.string"</span>, <span class='st'>"loc.string1"</span>, <span class='st'>"loc.string2"</span><span class='op'>)</span>,
  gazet <span class='op'>=</span> <span class='st'>"plantR"</span>,
  gazet.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"loc"</span>, <span class='st'>"loc.correct"</span>, <span class='st'>"latitude.gazetteer"</span>, <span class='st'>"longitude.gazetteer"</span>,
    <span class='st'>"resolution.gazetteer"</span><span class='op'>)</span>,
  orig.names <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data.frame containing the strings for locality search. See details
for the specifications of this data frame.</p></td>
    </tr>
    <tr>
      <th>str.names</th>
      <td><p>a vector of at least two columns names containing the
locality resolution and search string(s), in that order. Defaults to
'resol.orig', 'loc.string', 'loc.string1' and 'loc.string2'.</p></td>
    </tr>
    <tr>
      <th>gazet</th>
      <td><p>a data.frame containing the gazetteer. The default is "plantR",
the internal <strong>plantR</strong> gazetteer (biased towards Latin America).</p></td>
    </tr>
    <tr>
      <th>gazet.names</th>
      <td><p>a vector of at least four columns names containing the
locality search string, latitude and longitude, in that order. If
available, the resolution of the gazetteer can be provided as a fifth name.
Defaults to columns names of the <strong>plantR</strong> gazetteer: 'loc',
'loc.correct', 'latitude.gazetteer', 'longitude.gazetteer' and
'resolution.gazetteer'.</p></td>
    </tr>
    <tr>
      <th>orig.names</th>
      <td><p>logical. Should the original columns names of the gazetteer
be preserved. Default to FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The data frame <code>x</code>, with the new columns retrieved from the
gazetteer. More specifically, it returns the string used for the search in
the gazetteer (column 'loc'), the string retrieved (if any, column
'loc.correct'), the geographical coordinates (in decimal degrees) and the
resolution associated with the string retrieved (columns
'latitude.gazetteer', 'longitude.gazetteer', and 'resolution.gazetteer',
respectively) and the associated resolution.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function was initially designed as part of a larger routine to
edit and validate locality information from plant occurrence data. It is
possible to use it separately, but it may be easier to use it under the
workflow presented in the <strong>plantR</strong> manual. If used separately, users must
provide a data frame with at least two columns ('resol.orig' and
'loc.string'). Other locality strings ('loc.string1' and 'loc.string2') may
also be provided and in this case, these additional strings are used to
search for information below the municipality/county level, that is, to
retrieve from the gazetteer information at the locality level or below. If
these columns have different names in <code>x</code>, these names can be supplied
using, the argument <code>str.names</code>. See Examples below.</p>
<p>The default <strong>plantR</strong> gazetteer includes information for all countries at
the country level (i.e. administrative level 0) and at the lowest
administrative level available for all Latin at GDAM
(<a href='https://gadm.org'>https://gadm.org</a>) for 51 Latin American countries. For Brazil, the
gazetteer also contains information at the locality level (e.g. farms,
forest fragments, parks), obtained from <a href='https://www.ibge.gov.br/'>IBGE</a>,
<a href='http://cncflora.jbrj.gov.br'>CNCFlora</a> and
<a href='http://labtrop.ib.usp.br/doku.php?id=projetos:treeco:start'>TreeCo</a>
databases. It also includes common spelling variants and historical changes
to locality names (currently biased for Brazil) and more common notation
variants of locality names found in the locality description of records
from GBIF, speciesLink and JABOT databases (include few type localities).
In total the gazetteer has nearly 25,000 locality names associated with a
valid geographical coordinates.</p>
<p>A different gazetteer than the <strong>plantR</strong> default can be used. This
gazetteer must be provided using the argument <code>gazet</code> and it must contain
the columns 'loc' (search string), 'loc.correct' (correct string),
'latitude.gazetteer', 'longitude.gazetteer' (in decimal degrees) and
'resolution.gazetteer' (e.g. country, state, etc). If the names for these
columns are different, they can be supplied using argument <code>gazet.names</code>.</p>
<p>It is important to stress that the retrieval of locality information
depends on the completeness of the gazetteer itself. So, if a query does
not find a "valid" locality, it does not necessarily mean that the locality
does not exist or that its notation is wrong. It can simply mean that the
gazetteer is incomplete for the region you are working with. The gazetteer
is permanently being improved. If you find an error or if you want to
contribute with region-specific gazetteers, please send an email to
<a href='mailto:raflima@usp.br'>raflima@usp.br</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='fixLoc.html'>fixLoc</a>, <a href='strLoc.html'>strLoc</a> and <a href='prepLoc.html'>prepLoc</a>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Renato A. F. de Lima</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## Using the function separately (need to provide column names and</span>
<span class='co'>#strings in an specific format)</span>
<span class='op'>(</span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>resol <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"municipality"</span>,<span class='st'>"locality"</span><span class='op'>)</span>,
                  loc <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"brazil_rio janeiro_parati"</span>,<span class='st'>"brazil_rio janeiro_paraty"</span><span class='op'>)</span>,
                  loc1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>, <span class='st'>"brazil_rio janeiro_paraty_paraty mirim"</span><span class='op'>)</span>,
                  stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          resol                       loc                                   loc1
#&gt; 1 municipality brazil_rio janeiro_parati                                   &lt;NA&gt;
#&gt; 2     locality brazil_rio janeiro_paraty brazil_rio janeiro_paraty_paraty mirim</div><div class='input'><span class='fu'>getLoc</span><span class='op'>(</span><span class='va'>df</span>, str.names <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"resol"</span>, <span class='st'>"loc"</span>, <span class='st'>"loc1"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          resol                       loc                                   loc1
#&gt; 1 municipality brazil_rio janeiro_parati                                   &lt;NA&gt;
#&gt; 2     locality brazil_rio janeiro_paraty brazil_rio janeiro_paraty_paraty mirim
#&gt;                                      loc                            loc.correct
#&gt; 1              brazil_rio janeiro_parati              brazil_rio janeiro_paraty
#&gt; 2 brazil_rio janeiro_paraty_paraty mirim brazil_rio janeiro_paraty_paraty mirim
#&gt;   latitude.gazetteer longitude.gazetteer resolution.gazetteer
#&gt; 1          -23.14822           -44.70691               county
#&gt; 2          -23.24565           -44.63922             locality</div><div class='input'>
<span class='co'>## Using the function under the __plantR__ workflow</span>
<span class='op'>(</span><span class='va'>df</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"BR"</span>, <span class='st'>"Brazil"</span>, <span class='st'>"Brasil"</span>, <span class='st'>"USA"</span><span class='op'>)</span>,
                     stateProvince <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"RJ"</span>, <span class='st'>"Rio de Janeiro"</span>,
                                       <span class='st'>"Rio de Janeiro"</span>,<span class='st'>"Florida"</span><span class='op'>)</span>,
                     municipality <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Paraty"</span>, <span class='st'>"Paraty"</span>, <span class='st'>"Parati"</span>, <span class='cn'>NA</span><span class='op'>)</span>,
                     locality <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>NA</span>,<span class='st'>"Paraty-Mirim"</span>, <span class='cn'>NA</span>, <span class='cn'>NA</span><span class='op'>)</span>,
                     stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   country  stateProvince municipality     locality
#&gt; 1      BR             RJ       Paraty         &lt;NA&gt;
#&gt; 2  Brazil Rio de Janeiro       Paraty Paraty-Mirim
#&gt; 3  Brasil Rio de Janeiro       Parati         &lt;NA&gt;
#&gt; 4     USA        Florida         &lt;NA&gt;         &lt;NA&gt;</div><div class='input'>
<span class='co'># Formating the locality information</span>
<span class='va'>occs.fix</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fixLoc.html'>fixLoc</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>

<span class='co'># Creating locality strings used to query the gazetteer</span>
<span class='va'>occs.locs</span> <span class='op'>&lt;-</span> <span class='fu'><a href='strLoc.html'>strLoc</a></span><span class='op'>(</span><span class='va'>occs.fix</span><span class='op'>)</span>

<span class='co'># Final editing the locality strings (reduces variation in locality notation)</span>
<span class='va'>occs.locs</span><span class='op'>$</span><span class='va'>loc.string</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prepLoc.html'>prepLoc</a></span><span class='op'>(</span><span class='va'>occs.locs</span><span class='op'>$</span><span class='va'>loc.string</span><span class='op'>)</span>
<span class='va'>occs.locs</span><span class='op'>$</span><span class='va'>loc.string1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prepLoc.html'>prepLoc</a></span><span class='op'>(</span><span class='va'>occs.locs</span><span class='op'>$</span><span class='va'>loc.string1</span><span class='op'>)</span>
<span class='va'>occs.locs</span><span class='op'>$</span><span class='va'>loc.string2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='prepLoc.html'>prepLoc</a></span><span class='op'>(</span><span class='va'>occs.locs</span><span class='op'>$</span><span class='va'>loc.string2</span><span class='op'>)</span>

<span class='co'># Making the query of the edited strings in the gazetter</span>
<span class='fu'>getLoc</span><span class='op'>(</span><span class='va'>occs.locs</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     country.new stateProvince.new municipality.new locality.new locality.scrap
#&gt; 1        brazil       rio janeiro           paraty         &lt;NA&gt;           &lt;NA&gt;
#&gt; 2        brazil    rio de janeiro           paraty paraty-mirim   paraty-mirim
#&gt; 3        brazil    rio de janeiro           parati         &lt;NA&gt;           &lt;NA&gt;
#&gt; 4 united states           florida             &lt;NA&gt;         &lt;NA&gt;           &lt;NA&gt;
#&gt;      resol.orig                loc.string
#&gt; 1  municipality brazil_rio janeiro_paraty
#&gt; 2      locality brazil_rio janeiro_paraty
#&gt; 3  municipality brazil_rio janeiro_parati
#&gt; 4 stateProvince     united states_florida
#&gt;                              loc.string1                     loc.string2
#&gt; 1                                   &lt;NA&gt;                            &lt;NA&gt;
#&gt; 2 brazil_rio janeiro_paraty_paraty mirim brazil_rio janeiro_paraty mirim
#&gt; 3                                   &lt;NA&gt;                            &lt;NA&gt;
#&gt; 4                                   &lt;NA&gt;                            &lt;NA&gt;
#&gt;                                      loc                            loc.correct
#&gt; 1              brazil_rio janeiro_paraty              brazil_rio janeiro_paraty
#&gt; 2 brazil_rio janeiro_paraty_paraty mirim brazil_rio janeiro_paraty_paraty mirim
#&gt; 3              brazil_rio janeiro_parati              brazil_rio janeiro_paraty
#&gt; 4                  united states_florida                          united states
#&gt;   latitude.gazetteer longitude.gazetteer resolution.gazetteer
#&gt; 1          -23.14822           -44.70691               county
#&gt; 2          -23.24565           -44.63922             locality
#&gt; 3          -23.14822           -44.70691               county
#&gt; 4           39.52944           -99.15207              country</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Renato A. Ferreira de Lima, Sara R. Mortara, Andrea Sánchez-Tapia.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


